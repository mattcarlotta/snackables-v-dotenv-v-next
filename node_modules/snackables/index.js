"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.config=exports.parse=void 0;var fs_1=require("fs"),path_1=require("path"),_a=process.env,ENV_LOAD=_a.ENV_LOAD,ENV_DEBUG=_a.ENV_DEBUG,ENV_ENCODE=_a.ENV_ENCODE;function parse(e){var r={};function n(e){var s=e.match(/(.?\${?(?:[a-zA-Z0-9_]+)?}?)/g);return s?s.reduce((function(e,s){var t,a,o=/(.?)\${?([a-zA-Z0-9_]+)?}?/g.exec(s);return o?("\\"===o[1]?t=(a=o[0]).replace("\\$","$"):(a=o[0].substring(o[1].length),t=n(process.env[o[2]]||r[o[2]]||"")),e.replace(a,t)):e}),e):e}return e.toString().split(/\n|\r|\r\n/).forEach((function(e){var s=e.match(/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/);if(null!=s){var t=s[2]||"",a=t.length-1,o='"'===t[0]&&'"'===t[a];"'"===t[0]&&"'"===t[a]||o?(t=t.substring(1,a),o&&(t=t.replace(/\\n/g,"\n"))):t=t.trim(),r[s[1]]=n(t)}})),r}function config(e){for(var r=e&&e.path?e.path:".env",n=!(!e||!e.debug)&&e.debug,s=e&&e.encoding?e.encoding:"utf-8",t=Array.isArray(r)?r:r.split(","),a={},o=0;o<t.length;o+=1){var c=t[o],i=c.indexOf(".env")>-1?c:".env."+c;try{var g=path_1.resolve(process.cwd(),i);fs_1.statSync(g).isFile();var p=parse(fs_1.readFileSync(g,{encoding:s}));Object.assign(a,p),n&&console.log("\x1b[90mExtracted '"+i+"' ENVs: "+JSON.stringify(p)+"\x1b[0m")}catch(l){console.log("\x1b[33mUnable to extract '"+i+"': "+l.message+".\x1b[0m")}}return Object.assign(process.env,a),n&&console.log("\x1b[90mAssigned "+JSON.stringify(a)+" to process.env\x1b[0m"),a}exports.parse=parse,exports.config=config,null!=ENV_LOAD&&config({path:ENV_LOAD,debug:Boolean(ENV_DEBUG),encoding:ENV_ENCODE});